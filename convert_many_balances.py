#!/usr/bin/python
# -*- coding: utf-8 -*-
# host = '10.60.4.20'
import json
from confluent_kafka import Producer, Consumer

# host = 'localhost'
host = '10.60.4.20'

producer = Producer({'bootstrap.servers': '%s:9093' % host})

topic = 'user_data'
key = 'transfer_balance'

# d = [{1, 10000}, {1, 10000}]

d = [
# {1, 2000000},
# {2, 2000000},
# {3, 4600108},
# {4, 97916280},
# {5, 2000000},
# {6, 2000000},
# {7, 2000000},
# {8, 2000000},
# {9, 2000000},
# {10, 2000000},
# {11, 864704631},
# {12, 2000000},
# {13, 3075612},
# {14, 2000000},
# {15, 794556930},
# {16, 2624340},
# {17, 3000000},
# {18, 2915570},
# {19, 2003846},
# {20, 2962110},
# {21, 2939980},
# {22, 3000000},
# {23, 2001900},
# {24, 2056520},
# {25, 2002405},
# {26, 2000000},
# {27, 2000000},
# {28, 2000000},
# {29, 2000000},
# {30, 2000000},
# {31, 2000000},
# {32, 1918177},
# {33, 2000000},
# {34, 2000000},
# {35, 2000000},
# {36, 1301600},
# {37, 29880000},
# {38, 1091700},
# {39, 2000000},
# {40, 2000000},
# {41, 1965620},
# {42, 2000000},
# {43, 2002880},
# {44, 2000000},
# {45, 1090350},
# {46, 1998400},
# {47, 1081250},
# {48, 2050920},
# {49, 2000108},
# {50, 1995720},
# {51, 1097980},
# {52, 2007740},
# {53, 1998140},
# {54, 2000000},
# {55, 2000000},
# {56, 2001450},
# {57, 2000000},
# {58, 1843840},
# {59, 2000480},
# {60, 1995700},
# {61, 2001800},
# {62, 2018180},
# {63, 2000000},
# {64, 1729500},
# {65, 2000000},
# {66, 2001660},
# {67, 1998960},
# {68, 2000000},
# {69, 2000000},
# {70, 1466400},
# {71, 2000000},
# {72, 938580},
# {73, 801485},
# {74, 1000000},
# {75, 1000270},
# {76, 913400},
# {77, 911800},
# {78, 1002480},
# {79, 1012660},
# {80, 1000000},
# {81, 1000000},
# {82, 1000000},
# {83, 24180},
# {84, 21070},
# {85, 908980},
# {86, 977700},
# {87, 965160},
# {88, 1000000},
# {89, 1000000},
# {90, 933090},
# {91, 1000000},
# {92, 715250},
# {93, 1000000},
# {94, 929200},
# {95, 1000000},
# {96, 1000000},
# {97, 333840},
# {98, 1000000},
# {99, 1000000},
# {100, 856358},
# {101, 1000000},
# {102, 959100},
# {103, 909210},
# {104, 822200},
# {105, 909300},
# {106, 910730},
# {107, 1000000},
# {108, 936160},
# {109, 1000000},
# {110, 1000000},
# {111, 998800},
# {112, 1000000},
# {113, 872720},
# {114, 1000000},
# {115, 996738},
# {116, 1001440},
# {117, 1477200},
# {118, 1000000},
# {119, 1000000},
{65524, 96000000},
]


for p in d:
    balance_amount, uid = p

    m = {
        "event":"convert_stable_request",
        "user_group_id":0,
        "user_id":uid,
        "dest_user_group_id":0,
        "dest_user_id":65286,
        "asset":"USDC",
        "asset_id": 2,
        "asset_precision": 6,
        "dest_asset":"USD",
        "dest_asset_id": 2,
        "dest_asset_precision": 6,
        "balance_amount": 0
    }

    print(json.dumps(m))
    # producer.produce(topic, json.dumps(m), key)


producer.flush()
